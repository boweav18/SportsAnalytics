loans %>%
mutate(int_rate = as.numeric(gsub("%","",int_rate))) %>%
group_by(int_rate) %>%
summarise(num = n(),avg_amnt = mean(loan_amnt)) %>%
filter(!is.na(int_rate) & num > 50) %>%
ggplot(aes(x=int_rate, y = avg_amnt)) +
geom_point(color = 'grey80') +
geom_smooth(method = 'loess',formula = y~x) +
theme_bw() +
labs(x = "Interest Rate", y="Average Number of Loans", title="Number of Loans by Interest Rate") +
theme(axis.ticks = element_blank(),
plot.title = element_text(size=18, hjust=0.5),
panel.border = element_blank(),
panel.grid.minor.y = element_line(linetype=2, color="grey95"),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="grey95"),
panel.grid.major.x = element_line(color="grey98"),
axis.title = element_text(face="bold"),
plot.caption = element_text(face="italic"))
# Plot the average loan amount for each interest rate where the interest rate was used >50 times
loans %>%
mutate(int_rate = as.numeric(gsub("%","",int_rate))) %>%
group_by(int_rate) %>%
summarise(num = n(),avg_amnt = mean(loan_amnt),avg_inc = mean(annual_inc)) %>%
filter(!is.na(int_rate) & num > 50) %>%
ggplot(aes(x=int_rate, y = avg_amnt, size = avg_inc)) +
geom_point(color = 'grey80') +
geom_smooth(method = 'loess',formula = y~x) +
theme_bw() +
labs(x = "Interest Rate", y="Average Number of Loans", title="Number of Loans by Interest Rate") +
theme(axis.ticks = element_blank(),
plot.title = element_text(size=18, hjust=0.5),
panel.border = element_blank(),
panel.grid.minor.y = element_line(linetype=2, color="grey95"),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="grey95"),
panel.grid.major.x = element_line(color="grey98"),
axis.title = element_text(face="bold"),
plot.caption = element_text(face="italic"))
# Plot the average loan amount for each interest rate where the interest rate was used >50 times
loans %>%
mutate(int_rate = as.numeric(gsub("%","",int_rate))) %>%
group_by(int_rate) %>%
summarise(num = n(),avg_amnt = mean(loan_amnt),avg_inc = mean(dti)) %>%
filter(!is.na(int_rate) & num > 50) %>%
ggplot(aes(x=int_rate, y = avg_amnt, size = avg_inc)) +
geom_point(color = 'grey80') +
geom_smooth(method = 'loess',formula = y~x) +
theme_bw() +
labs(x = "Interest Rate", y="Average Number of Loans", title="Number of Loans by Interest Rate") +
theme(axis.ticks = element_blank(),
plot.title = element_text(size=18, hjust=0.5),
panel.border = element_blank(),
panel.grid.minor.y = element_line(linetype=2, color="grey95"),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="grey95"),
panel.grid.major.x = element_line(color="grey98"),
axis.title = element_text(face="bold"),
plot.caption = element_text(face="italic"))
# Plot the average loan amount for each interest rate where the interest rate was used >50 times
loans %>%
mutate(int_rate = as.numeric(gsub("%","",int_rate))) %>%
group_by(int_rate) %>%
summarise(num = n(),avg_amnt = mean(loan_amnt),avg_inc = mean(last_pymnt_amnt)) %>%
filter(!is.na(int_rate) & num > 50) %>%
ggplot(aes(x=int_rate, y = avg_amnt, size = avg_inc)) +
geom_point(color = 'grey80') +
geom_smooth(method = 'loess',formula = y~x) +
theme_bw() +
labs(x = "Interest Rate", y="Average Number of Loans", title="Number of Loans by Interest Rate") +
theme(axis.ticks = element_blank(),
plot.title = element_text(size=18, hjust=0.5),
panel.border = element_blank(),
panel.grid.minor.y = element_line(linetype=2, color="grey95"),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="grey95"),
panel.grid.major.x = element_line(color="grey98"),
axis.title = element_text(face="bold"),
plot.caption = element_text(face="italic"))
# Plot the average loan amount for each interest rate where the interest rate was used >50 times
loans %>%
mutate(int_rate = as.numeric(gsub("%","",int_rate))) %>%
group_by(int_rate) %>%
summarise(num = n(),avg_amnt = mean(loan_amnt),avg_lpa = mean(last_pymnt_amnt)) %>%
filter(!is.na(int_rate) & num > 50) %>%
ggplot(aes(x=int_rate, y = avg_amnt, size = avg_lpa)) +
geom_point(color = 'grey80') +
geom_smooth(method = 'loess',formula = y~x) +
theme_bw() +
labs(x = "Interest Rate", y="Average Number of Loans", title="Number of Loans by Interest Rate") +
theme(axis.ticks = element_blank(),
plot.title = element_text(size=18, hjust=0.5),
panel.border = element_blank(),
panel.grid.minor.y = element_line(linetype=2, color="grey95"),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="grey95"),
panel.grid.major.x = element_line(color="grey98"),
axis.title = element_text(face="bold"),
plot.caption = element_text(face="italic"))
# Plot the average loan amount for each interest rate where the interest rate was used >50 times
loans %>%
mutate(int_rate = as.numeric(gsub("%","",int_rate))) %>%
group_by(int_rate) %>%
summarise(num = n(),avg_amnt = mean(loan_amnt),avg_lpa = mean(last_pymnt_amnt)) %>%
filter(!is.na(int_rate) & num > 50) %>%
ggplot(aes(x=int_rate, y = avg_amnt, color = avg_lpa)) +
geom_point(color = 'grey80') +
geom_smooth(method = 'loess',formula = y~x) +
theme_bw() +
labs(x = "Interest Rate", y="Average Number of Loans", title="Number of Loans by Interest Rate") +
theme(axis.ticks = element_blank(),
plot.title = element_text(size=18, hjust=0.5),
panel.border = element_blank(),
panel.grid.minor.y = element_line(linetype=2, color="grey95"),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="grey95"),
panel.grid.major.x = element_line(color="grey98"),
axis.title = element_text(face="bold"),
plot.caption = element_text(face="italic"))
# Plot the average loan amount for each interest rate where the interest rate was used >50 times
loans %>%
mutate(int_rate = as.numeric(gsub("%","",int_rate))) %>%
group_by(int_rate) %>%
summarise(num = n(),avg_amnt = mean(loan_amnt),avg_lpa = mean(last_pymnt_amnt)) %>%
filter(!is.na(int_rate) & num > 50) %>%
ggplot(aes(x=int_rate, y = avg_amnt, color = avg_lpa)) +
geom_point() +
geom_smooth(method = 'loess',formula = y~x) +
theme_bw() +
labs(x = "Interest Rate", y="Average Number of Loans", title="Number of Loans by Interest Rate") +
theme(axis.ticks = element_blank(),
plot.title = element_text(size=18, hjust=0.5),
panel.border = element_blank(),
panel.grid.minor.y = element_line(linetype=2, color="grey95"),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="grey95"),
panel.grid.major.x = element_line(color="grey98"),
axis.title = element_text(face="bold"),
plot.caption = element_text(face="italic"))
# Plot the average loan amount for each interest rate where the interest rate was used >50 times
loans %>%
mutate(int_rate = as.numeric(gsub("%","",int_rate))) %>%
group_by(int_rate) %>%
summarise(num = n(),avg_amnt = mean(loan_amnt),avg_lpa = mean(last_pymnt_amnt)) %>%
filter(!is.na(int_rate) & num > 50) %>%
ggplot(aes(x=int_rate, y = avg_amnt, size = avg_lpa)) +
geom_point(color = 'grey10') +
geom_smooth(method = 'loess',formula = y~x) +
theme_bw() +
labs(x = "Interest Rate", y="Average Number of Loans", title="Number of Loans by Interest Rate") +
theme(axis.ticks = element_blank(),
plot.title = element_text(size=18, hjust=0.5),
panel.border = element_blank(),
panel.grid.minor.y = element_line(linetype=2, color="grey95"),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="grey95"),
panel.grid.major.x = element_line(color="grey98"),
axis.title = element_text(face="bold"),
plot.caption = element_text(face="italic"))
# Plot the average loan amount for each interest rate where the interest rate was used >50 times
loans %>%
mutate(int_rate = as.numeric(gsub("%","",int_rate))) %>%
group_by(int_rate) %>%
summarise(num = n(),avg_amnt = mean(loan_amnt),avg_lpa = mean(last_pymnt_amnt)) %>%
filter(!is.na(int_rate) & num > 50) %>%
ggplot(aes(x=int_rate, y = avg_amnt, size = avg_lpa)) +
geom_point(color = 'grey50') +
geom_smooth(method = 'loess',formula = y~x) +
theme_bw() +
labs(x = "Interest Rate", y="Average Number of Loans", title="Number of Loans by Interest Rate") +
theme(axis.ticks = element_blank(),
plot.title = element_text(size=18, hjust=0.5),
panel.border = element_blank(),
panel.grid.minor.y = element_line(linetype=2, color="grey95"),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="grey95"),
panel.grid.major.x = element_line(color="grey98"),
axis.title = element_text(face="bold"),
plot.caption = element_text(face="italic"))
# Plot the average loan amount for each interest rate where the interest rate was used >50 times
loans %>%
mutate(int_rate = as.numeric(gsub("%","",int_rate))) %>%
group_by(int_rate) %>%
summarise(num = n(),avg_amnt = mean(loan_amnt),avg_lpa = mean(last_pymnt_amnt)) %>%
filter(!is.na(int_rate) & num > 50) %>%
ggplot(aes(x=int_rate, y = avg_amnt, color = avg_lpa)) +
geom_point() +
scale_fill_continuous("Average Last Payment Amount",low = 'white', high = 'navyblue') +
geom_smooth(method = 'loess',formula = y~x) +
theme_bw() +
labs(x = "Interest Rate", y="Average Number of Loans", title="Number of Loans by Interest Rate") +
theme(axis.ticks = element_blank(),
plot.title = element_text(size=18, hjust=0.5),
panel.border = element_blank(),
panel.grid.minor.y = element_line(linetype=2, color="grey95"),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="grey95"),
panel.grid.major.x = element_line(color="grey98"),
axis.title = element_text(face="bold"),
plot.caption = element_text(face="italic"))
# Plot the average loan amount for each interest rate where the interest rate was used >50 times
loans %>%
mutate(int_rate = as.numeric(gsub("%","",int_rate))) %>%
group_by(int_rate) %>%
summarise(num = n(),avg_amnt = mean(loan_amnt),avg_lpa = mean(last_pymnt_amnt)) %>%
filter(!is.na(int_rate) & num > 50) %>%
ggplot(aes(x=int_rate, y = avg_amnt, color = avg_lpa)) +
geom_point() +
scale_fill_continuous(low = 'white', high = 'navyblue') +
geom_smooth(method = 'loess',formula = y~x) +
theme_bw() +
labs(x = "Interest Rate", y="Average Number of Loans", title="Number of Loans by Interest Rate") +
theme(axis.ticks = element_blank(),
plot.title = element_text(size=18, hjust=0.5),
panel.border = element_blank(),
panel.grid.minor.y = element_line(linetype=2, color="grey95"),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="grey95"),
panel.grid.major.x = element_line(color="grey98"),
axis.title = element_text(face="bold"),
plot.caption = element_text(face="italic"))
# Plot the average loan amount for each interest rate where the interest rate was used >50 times
loans %>%
mutate(int_rate = as.numeric(gsub("%","",int_rate))) %>%
group_by(int_rate) %>%
summarise(num = n(),avg_amnt = mean(loan_amnt),avg_lpa = mean(last_pymnt_amnt)) %>%
filter(!is.na(int_rate) & num > 50) %>%
ggplot(aes(x=int_rate, y = avg_amnt, size = avg_lpa)) +
geom_point() +
geom_smooth(method = 'loess',formula = y~x) +
theme_bw() +
labs(x = "Interest Rate", y="Average Number of Loans", title="Number of Loans by Interest Rate") +
theme(axis.ticks = element_blank(),
plot.title = element_text(size=18, hjust=0.5),
panel.border = element_blank(),
panel.grid.minor.y = element_line(linetype=2, color="grey95"),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="grey95"),
panel.grid.major.x = element_line(color="grey98"),
axis.title = element_text(face="bold"),
plot.caption = element_text(face="italic"))
# Plot the average loan amount for each interest rate where the interest rate was used >50 times
loans %>%
mutate(int_rate = as.numeric(gsub("%","",int_rate))) %>%
group_by(int_rate) %>%
summarise(num = n(),avg_amnt = mean(loan_amnt),avg_lpa = mean(last_pymnt_amnt)) %>%
filter(!is.na(int_rate) & num > 50) %>%
ggplot(aes(x=int_rate, y = avg_amnt, size = avg_lpa)) +
geom_point(color = 'grey50') +
geom_smooth(method = 'loess',formula = y~x) +
theme_bw() +
labs(x = "Interest Rate", y="Average Number of Loans", title="Number of Loans by Interest Rate") +
theme(axis.ticks = element_blank(),
plot.title = element_text(size=18, hjust=0.5),
panel.border = element_blank(),
panel.grid.minor.y = element_line(linetype=2, color="grey95"),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="grey95"),
panel.grid.major.x = element_line(color="grey98"),
axis.title = element_text(face="bold"),
plot.caption = element_text(face="italic"))
# Plot the average loan amount for each interest rate where the interest rate was used >50 times
loans %>%
mutate(int_rate = as.numeric(gsub("%","",int_rate))) %>%
group_by(int_rate) %>%
summarise(num = n(),avg_amnt = mean(loan_amnt),avg_lpa = mean(last_pymnt_amnt)) %>%
filter(!is.na(int_rate) & num > 50) %>%
ggplot(aes(x=int_rate, y = avg_amnt, size = avg_lpa)) +
geom_point(color = 'grey50') +
geom_smooth(method = 'loess',formula = y~x) +
theme_bw() +
labs(x = "Interest Rate", y="Average Number of Loans", title="Number of Loans Against Interest Rate\nby Last Payment Amount") +
theme(axis.ticks = element_blank(),
plot.title = element_text(size=18, hjust=0.5),
panel.border = element_blank(),
panel.grid.minor.y = element_line(linetype=2, color="grey95"),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="grey95"),
panel.grid.major.x = element_line(color="grey98"),
axis.title = element_text(face="bold"),
plot.caption = element_text(face="italic"))
# Plot the average loan amount for each interest rate where the interest rate was used >50 times
loans %>%
mutate(int_rate = as.numeric(gsub("%","",int_rate))) %>%
group_by(int_rate) %>%
summarise(num = n(),avg_amnt = mean(loan_amnt),avg_lpa = mean(last_pymnt_amnt)) %>%
filter(!is.na(int_rate) & num > 50) %>%
ggplot(aes(x=int_rate, y = avg_amnt, size = avg_lpa)) +
geom_point(color = 'grey50') +
geom_smooth(method = 'loess',formula = y~x) +
theme_bw() +
labs(x = "Interest Rate", y="Average Loan Amount", title="Loan Amount Against Interest Rate\nby Last Payment Amount") +
theme(axis.ticks = element_blank(),
plot.title = element_text(size=18, hjust=0.5),
panel.border = element_blank(),
panel.grid.minor.y = element_line(linetype=2, color="grey95"),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="grey95"),
panel.grid.major.x = element_line(color="grey98"),
axis.title = element_text(face="bold"),
plot.caption = element_text(face="italic"))
shiny::runApp('SportsAnalytics')
runApp('SportsAnalytics')
#### IMPORT DATA ####
master <- read_csv("mastertotal.csv")
#### Dependencies ####
# uncomment when publishing
#source('masterbigTEST(1).R')
#setwd("C:/Users/andrb/OneDrive/Documents/SportsAnalytics")
library(shiny)
library(tidyverse)
library(purrr)
library(readxl)
#### IMPORT DATA ####
master <- read_csv("mastertotal.csv")
setwd("C:/Users/andrb/OneDrive/Documents/SportsAnalytics")
#### IMPORT DATA ####
master <- read_csv("mastertotal.csv")
View(master)
#### IMPORT DATA ####
master <- mastertotal <- read_csv("mastertotal.csv",
col_types = cols(X1 = col_skip()))
View(master)
#### IMPORT DATA ####
master <- read_csv("Master1Test.csv",
col_types = cols(X1 = col_skip()))
View(master)
runApp()
runApp()
master$"Name"
master %>% filter("Name" == "MIDDLETON")
runApp()
addFilter = function(tableName,number_add,add,eq,rhs){
for (i in 1:number_add){
if(eq[i] == 'Greater Than'){
rows = which(tableName$add[i] > rhs[i])
}
else if(eq_1 == 'Less Than'){
rows = which(tableName$add[i] < rhs[i])
}
else{
rows = which(tableName$add[i] == rhs[i])
}
tableName = tableName[rows,]
}
}
addFilter = function(tableName,number_add,add,eq,rhs){
for (i in 1:number_add){
if(eq[i] == 'Greater Than'){
rows = which(tableName$add[i] > rhs[i])
}
else if(eq_1 == 'Less Than'){
rows = which(tableName$add[i] < rhs[i])
}
else{
rows = which(tableName$add[i] == rhs[i])
}
return(tableName[rows,])
}
}
addFilter(master,1,c("RushAtt"),c('Greater Than'),c(50))
addFilter = function(tableName,number_add,add,eq,rhs){
print(add)
for (i in 1:number_add){
if(eq[i] == 'Greater Than'){
rows = which(tableName$add[i] > rhs[i])
}
else if(eq_1 == 'Less Than'){
rows = which(tableName$add[i] < rhs[i])
}
else{
rows = which(tableName$add[i] == rhs[i])
}
return(tableName[rows,])
}
}
addFilter(master,1,c("RushAtt"),c('Greater Than'),c(50))
master$"RushAtt"
addFilter = function(tableName,number_add,add,eq,rhs){
print(tableName)
for (i in 1:number_add){
if(eq[i] == 'Greater Than'){
rows = which(tableName$add[i] > rhs[i])
}
else if(eq_1 == 'Less Than'){
rows = which(tableName$add[i] < rhs[i])
}
else{
rows = which(tableName$add[i] == rhs[i])
}
return(tableName[rows,])
}
}
addFilter(master,1,c("RushAtt"),c('Greater Than'),c(50))
a = c("RushAtt")
master$a[1]
a[1]
name = a[1]
b = a[1]
master$b
master[,a[i]]
master[,a[1]]
addFilter = function(tableName,number_add,add,eq,rhs){
print(tableName)
for (i in 1:number_add){
if(eq[i] == 'Greater Than'){
rows = which(tableName[,add[i]] > rhs[i])
}
else if(eq_1 == 'Less Than'){
rows = which(tableName[,add[i]] < rhs[i])
}
else{
rows = which(tableName[,add[i]] == rhs[i])
}
return(tableName[rows,])
}
}
addFilter(master,1,c("RushAtt"),c('Greater Than'),c(50))
addFilter = function(tableName,number_add,add,eq,rhs){
rows = vector()
for (i in 1:number_add){
if(eq[i] == 'Greater Than'){
rows = which(tableName[,add[i]] > rhs[i])
}
else if(eq_1 == 'Less Than'){
rows = which(tableName[,add[i]] < rhs[i])
}
else{
rows = which(tableName[,add[i]] == rhs[i])
}
}
return(tableName[rows,])
}
addFilter(master,1,c("RushAtt"),c('Greater Than'),c(50))
addFilter = function(tableName,number_add,add,eq,rhs){
rows = vector()
for (i in 1:number_add){
print(i)
if(eq[i] == 'Greater Than'){
rows = which(tableName[,add[i]] > rhs[i])
}
else if(eq_1 == 'Less Than'){
rows = which(tableName[,add[i]] < rhs[i])
}
else{
rows = which(tableName[,add[i]] == rhs[i])
}
}
return(tableName[rows,])
}
addFilter(master,1,c("RushAtt"),c('Greater Than'),c(50))
addFilter = function(tableName,number_add,add,eq,rhs){
rows = vector()
for (i in 1:number_add){
print(tableName[,add[i]])
if(eq[i] == 'Greater Than'){
rows = which(tableName[,add[i]] > rhs[i])
}
else if(eq_1 == 'Less Than'){
rows = which(tableName[,add[i]] < rhs[i])
}
else{
rows = which(tableName[,add[i]] == rhs[i])
}
}
return(tableName[rows,])
}
addFilter(master,1,c("RushAtt"),c('Greater Than'),c(50))
addFilter = function(tableName,number_add,add,eq,rhs){
rows = vector()
for (i in 1:number_add){
if(eq[i] == 'Greater Than'){
rows = which(tableName[,add[i]] > rhs[i])
}
else if(eq_1 == 'Less Than'){
rows = which(tableName[,add[i]] < rhs[i])
}
else{
rows = which(tableName[,add[i]] == rhs[i])
}
}
return(tableName[rows,])
}
addFilter(master,1,c("RushAtt"),c('Greater Than'),c(5))
for(i in 1:0){print(i)}
runApp()
runApp()
runApp()
inner_join(c(1,2,3,4,5),c(2,3,4,5,6))
?inner_join
rows = 1:nrow(tableName)
rows = 1:nrow(master)
rows
runApp()
which(master$Name == 'asdfasdf')
a = which(master$Name == 'asdfasdf')
if(a){print('help')}
length(a)
master[NULL,]
runApp()
?dimnames
dimnames(master)
runApp()
master[NULL,]
c(1,2,3,4) %in% c(2,3,4,5)
intersect(c(1,2,3,4),c(2,3,4,5))
runApp('app_test.R')
runApp('app_test.R')
master[NULL,3]
master[NULL,3] < 0
runApp('app_test.R')
runApp()
